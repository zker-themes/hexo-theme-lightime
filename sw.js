"use strict";const version="v20160443",__DEVELOPMENT__=!1,__DEBUG__=!1,offlineResources=["/","/offline.html","/offline.svg"],ignoreFetch=[/https?:\/\/cdnjs.loli.net\//,/https?:\/\/fonts.loli.net\//,/https?:\/\/wx2.sinaimg.cn\//];function onInstall(e){log("install event in progress."),e.waitUntil(updateStaticCache())}function updateStaticCache(){return caches.open(cacheKey("offline")).then(e=>e.addAll(offlineResources)).then(()=>{log("installation complete!")})}function onFetch(e){const t=e.request;shouldAlwaysFetch(t)?e.respondWith(networkedOrOffline(t)):shouldFetchAndCache(t)?e.respondWith(networkedOrCached(t)):e.respondWith(cachedOrNetworked(t))}function networkedOrCached(e){return networkedAndCache(e).catch(()=>cachedOrOffline(e))}function networkedAndCache(e){return fetch(e).then(t=>{var n=t.clone();return caches.open(cacheKey("resources")).then(t=>{t.put(e,n)}),log("(network: cache write)",e.method,e.url),t})}function cachedOrNetworked(e){return caches.match(e).then(t=>(log(t?"(cached)":"(network: cache miss)",e.method,e.url),t||networkedAndCache(e).catch(()=>offlineResponse(e))))}function networkedOrOffline(e){return fetch(e).then(t=>(log("(network)",e.method,e.url),t)).catch(()=>offlineResponse(e))}function cachedOrOffline(e){return caches.match(e).then(t=>t||offlineResponse(e))}function offlineResponse(e){return log("(offline)",e.method,e.url),e.url.match(/\.(jpg|png|gif|svg|jpeg)(\?.*)?$/)?caches.match("/offline.svg"):caches.match("/offline.html")}function onActivate(e){log("activate event in progress."),e.waitUntil(removeOldCache())}function removeOldCache(){return caches.keys().then(e=>Promise.all(e.filter(e=>!e.startsWith(version)).map(e=>caches.delete(e)))).then(()=>{log("removeOldCache completed.")})}function cacheKey(){return[version,...arguments].join(":")}function log(){developmentMode()&&console.log("SW:",...arguments)}function shouldAlwaysFetch(e){return __DEVELOPMENT__||"GET"!==e.method||ignoreFetch.some(t=>e.url.match(t))}function shouldFetchAndCache(e){return~e.headers.get("Accept").indexOf("text/html")}function developmentMode(){return __DEVELOPMENT__||__DEBUG__}log("Hello from ServiceWorker land!",version),self.addEventListener("install",onInstall),self.addEventListener("fetch",onFetch),self.addEventListener("activate",onActivate);