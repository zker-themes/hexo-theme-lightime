<%
var last;
var title = '';
if (page.category) title = page.category;
if (page.tag) title = page.tag;
if (page.archive){
  if (page.year) title = page.year + (page.month ? '/' + page.month : '');
}
%>

<%- partial('profile') %>
<h2 style="font-size:2em;color:#5694f1" class="archive-title<% if (page.tag){ %>-tag<% } else if (page.category){ %>-category<% } else if (page.archive){ %>-archive<% } %>"><% if (page.tag){ %><%= __('tag') %><% } else if (page.category){ %><%= __('category') %><% } else if (page.archive) { %><%= __('archive_a') %><% } %>:<%= title %></h2>
<% if (page.archive){ %>
	<div class="tagclound">
		<h2><%= __('tagclound') %></h2>
		<% site.tags.map(function(tag){  %>
    		<a href="<%- config.root %>tags/<%= tag.name %>" title="<%= tag.name %>"><%= tag.name %><span>(<%= tag.length %>)</span></a>
    	<% }) %>
    </div>
	<div class="category">
		<h2><%= __('category') %></h2>
		<% site.categories.map(function(category){  %>
    		<a href="<%- config.root %>categories/<%= category.name %>" title="<%= category.name %>"><%= category.name %><span>(<%= category.length %>)</span></a>
    	<% }) %>
    </div>
    <% site.posts.sort('date', 'desc').each(function(item){ %>
        <% var year = item.date.year(); %>
        <% if (last != year){ %>
            <% if (last != null){ %>
                </ul>
            <% } %>
            <% last = year; %>
            <h2><%= year %></h2>
            <ul id="post-list">
        <% } %>
        <%- partial('_partial/title', {item: item, index: true}) %>
        <% }); %>
        </ul>
<% } else { %>
    <ul id="post-list">
        <% page.posts.each(function(item){ %>
            <%- partial('_partial/title', {item: item, index: true}) %>
        <% }); %>
    </ul>
    <%- partial('_partial/pagination') %>
<% } %>